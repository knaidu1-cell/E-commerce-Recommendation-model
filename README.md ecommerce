ğŸš€ E-commerce Recommender System using Spark ALS

This project builds a scalable, end-to-end product recommendation engine for an e-commerce platform using Apache Sparkâ€™s ALS (Alternating Least Squares) algorithm. The system integrates transactional, behavioral, and review data to deliver personalized top-N product recommendations to customers.

â­ Project Summary 

Developed a distributed recommendation model capable of handling large-scale e-commerce data. The pipeline performs data ingestion, feature engineering, EDA, model training, evaluation, and recommendation generation â€” all in a single unified PySpark notebook.

ğŸ§© Key Objectives

Integrate real-world e-commerce data (orders, products, customers, reviews).

Build explicit and implicit userâ€“item interaction matrices for ALS.

Train and tune a scalable collaborative filtering model.

Evaluate ranking performance using Precision@K and other metrics.

Generate top-N personalized recommendations for customers and segments.

ğŸ”§ Tech Stack

Python Â· Apache Spark (MLlib ALS) Â· PySpark Â· Pandas Â· NumPy Â· Matplotlib Â· Seaborn Â· Jupyter Notebook

ğŸ› ï¸ Data Preprocessing & Feature Engineering

Joined multi-table e-commerce dataset (orders, order_items, products, sellers, reviews).

Performed missing-value imputation, outlier removal, and log transformation of skewed price/freight distributions.

Engineered customerâ€“product interaction features including:

Recency (days since last purchase)

Frequency (# of orders and distinct items purchased)

Monetary value (order totals)

Product metadata (category, subcategory, attributes)

Review-based scores

Indexed customer and product IDs using StringIndexer for ALS compatibility.

Constructed explicit (ratings) and implicit (purchase count) interaction matrices.

ğŸ“Š Exploratory Data Analysis (EDA)

Analyzed order values, price distributions, freight costs, customer behavior, and review patterns.

Computed category-level aggregates:

Avg price

Total orders

Number of unique products

Built RFM segmentation to understand customer purchase behavior.

Visualized sales trends, customer activity, and rating distributions.

ğŸ¤– Model Development â€” Spark MLlib ALS

Constructed userâ€“item rating matrix combining purchase frequency, recency, and review sentiment.

Trained ALS model with hyperparameters:

rank (latent factors)

maxIter

regParam

cold-start strategy

Used trainâ€“validation split to optimize model performance.

Implemented both explicit and implicit feedback versions of ALS.

ğŸ“ˆ Evaluation

Measured recommendation quality with Precision@K, NDCG, and Hit Rate.

Validated using held-out customerâ€“product interactions.

Compared ALS implicit vs. explicit models and analyzed tradeoffs.

ğŸ¯ Recommendation Generation

Generated Top-N product recommendations per customer.

Personalized suggestions based on behavioral patterns and predicted affinity scores.

Created examples of:

User profiles

Recommended product lists

Score interpretations

Segmented users (new vs. frequent vs. high-value customers) to compare recommendation patterns.

ğŸ’¡ Outcome

Delivered a scalable, production-ready recommendation engine capable of powering personalization for an e-commerce platform. The system can be extended to:

Dynamic pricing

Cross-sell & upsell strategies

Personalized marketing campaigns

Customer segmentation workflows


The Dataset is from a public dataset from OList, a Brazilian Ecommerce store:
https://www.kaggle.com/datasets/olistbr/brazilian-ecommerce?select=olist_products_dataset.csv]

References:
[1] https://medium.com/@brunoborges_38708/recommender-system-using-als-in-pyspark-10329e1d1ee1
[2] https://towardsdatascience.com/recommendation-system-matrix-factorization-d61978660b4b
[3] https://medium.com/@eliasah/deep-dive-into-matrix-factorization-for-recommender-systems-from-basics-to-implementation-79e4f1ea1660
[4] https://haneulkim.medium.com/matrix-factorization-part-i-from-derivation-of-stochastic-gradient-descent-step-to-learning-17a7d8975965

